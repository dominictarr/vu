
<!DOCTYPE html>
  <html>
    <head>
    <script src="./lib/events.js"></script>
    <script src="./lib/model.js"></script>
    <script src="./lib/widget.js"></script>
    <script src="./lib/client.js"></script>
    </head>
    <body>
    </body>
  <script>

  var thing = new Model({
      a: 'aardvark', b: 'banana', time: new Date(),
      whatevs: 'aoecmnpmwqkvm'
  })

  function input (value, key, model) {
    if(this.init)
      return vu(
        [ 'input', 
          { type: 'text', 
            onchange: function () {
              //use try - catch to check for validation fail.
              //or, should the model emit an error?
              model.set(key, this.value)
            },
            value: value
          } 
        ])
    else this.value = value
    //if a value render function returns null that means
    //that it has updated the element, do not replace element.
  }

  var thingWidget = widget(function (t) {
    return vu(
      ['div.thing', {}, this('a'),' ', this('b'), 
        ['div', 'TIME:',this('time', function (time) {
          return [
            time.getHours(),  
            time.getMinutes(), 
            time.getSeconds()
          ].join(':')
        })],
        this('whatevs', input) 
      ]
    );
 })

document.body.appendChild(thingWidget(thing))

var bs = ['banana', 'beer', 'boat']
var as = ['aardvark', 'apple', 'anykey']

function cycle (array) {
  var a = array.shift()
  array.push(a)
  return a
}

setInterval(function () {
  thing.set('time', new Date())
  if(Math.random() > 0.5)
    thing.set('a', cycle(as))
  else
    thing.set('b', cycle(bs))
}, 1e3)

</script>
</html>
